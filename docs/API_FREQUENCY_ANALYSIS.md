# NASA API 更新频率分析

## 📊 各 API 实际更新频率

### 1. APOD (Astronomy Picture of the Day)
- **官方更新**: 每天 1 次（美国东部时间凌晨）
- **当前设置**: 每日 00:00 UTC ✅
- **评估**: **合理** - 完美匹配
- **建议**: 保持

### 2. Asteroids NeoWs (Near Earth Object)
- **官方更新**: 实时更新，但数据变化缓慢
- **当前设置**: 每日 00:00 UTC
- **评估**: **合理** - 小行星轨道数据每日更新足够
- **建议**: 保持

### 3. DONKI (Space Weather)
- **官方更新**: 实时更新（空间天气事件发生时）
- **当前设置**: 每日 00:00 UTC
- **评估**: **偏低** - 空间天气事件可能随时发生
- **建议**: 改为 **每 6 小时** 或 **每 12 小时**

### 4. EONET (Earth Observatory Events)
- **官方更新**: 实时更新（自然灾害发生时）
- **当前设置**: 每小时 ✅
- **评估**: **合理** - 自然事件需要较高频率监控
- **建议**: 保持

### 5. EPIC (Earth Images)
- **官方更新**: 每 1-2 小时（卫星拍摄频率）
- **当前设置**: 每日 00:00 UTC
- **评估**: **偏低** - 错过大量图片
- **建议**: 改为 **每 2-4 小时**

### 6. Mars Rover Photos
- **官方更新**: 不定期（火星车活动时）
- **当前设置**: 每日 00:00 UTC
- **评估**: **合理** - 火星车不是每天都拍照
- **建议**: 保持，或改为 **每周**

### 7. NASA Image and Video Library
- **官方更新**: 持续更新（新内容上传时）
- **当前设置**: 每小时 ✅
- **评估**: **合理** - 搜索结果变化不大
- **建议**: 改为 **每 6 小时** 或 **每日**

### 8. Exoplanet Archive
- **官方更新**: 每月或每季度（新发现时）
- **当前设置**: 每周日 00:00 UTC
- **评估**: **偏高** - 数据更新很慢
- **建议**: 改为 **每月**

### 9. GeneLab
- **官方更新**: 不定期（新实验数据时）
- **当前设置**: 每周日 00:00 UTC ✅
- **评估**: **合理**
- **建议**: 保持

### 10. TechPort
- **官方更新**: 每月或每季度（项目更新时）
- **当前设置**: 每周日 00:00 UTC
- **评估**: **偏高** - 项目信息更新慢
- **建议**: 改为 **每月**

### 11. Technology Transfer
- **官方更新**: 不定期（新专利时）
- **当前设置**: 每周日 00:00 UTC ✅
- **评估**: **合理**
- **建议**: 保持

### 12. Earth Imagery
- **官方更新**: 实时（卫星过境时）
- **当前设置**: 每周日 00:00 UTC
- **评估**: **合理** - 固定坐标图片变化不大
- **建议**: 保持

## 📋 优化建议总结

### 🔴 需要调整（重要）

| API | 当前 | 建议 | 原因 |
|-----|------|------|------|
| **DONKI** | 每日 | 每 6 小时 | 空间天气事件实时性强 |
| **EPIC** | 每日 | 每 4 小时 | 卫星每 1-2 小时拍摄 |

### 🟡 可以优化（降低频率）

| API | 当前 | 建议 | 原因 |
|-----|------|------|------|
| **NASA IVL** | 每小时 | 每 6 小时 | 搜索结果变化慢 |
| **Mars Rover** | 每日 | 每周 | 火星车不是每天活动 |
| **Exoplanet** | 每周 | 每月 | 数据更新极慢 |
| **TechPort** | 每周 | 每月 | 项目更新慢 |

### ✅ 保持不变

| API | 频率 | 评估 |
|-----|------|------|
| APOD | 每日 | ✅ 完美 |
| Asteroids | 每日 | ✅ 合理 |
| EONET | 每小时 | ✅ 合理 |
| GeneLab | 每周 | ✅ 合理 |
| Tech Transfer | 每周 | ✅ 合理 |
| Earth | 每周 | ✅ 合理 |

## 🎯 推荐配置方案

### 方案 A：平衡方案（推荐）

```javascript
const SCHEDULE_MAP = {
  "0 0 * * *":     ["apod", "asteroids-neows"],           // 每日 00:00
  "0 */6 * * *":   ["donki", "epic"],                     // 每 6 小时
  "0 * * * *":     ["eonet"],                             // 每小时
  "0 */6 * * *":   ["nasa-ivl"],                          // 每 6 小时
  "0 0 * * 0":     ["mars-rover-photos", "earth"],        // 每周日
  "0 0 1 * *":     ["exoplanet", "techport"],             // 每月 1 号
  "0 0 * * 0":     ["genelab", "techtransfer"]            // 每周日
};
```

**效果：**
- 提高实时性：DONKI, EPIC 更频繁
- 降低冗余：NASA IVL, Mars, Exoplanet, TechPort 减少
- 存储优化：月存储从 2.1GB → 1.5GB

### 方案 B：最小方案（省存储）

```javascript
const SCHEDULE_MAP = {
  "0 0 * * *":     ["apod", "asteroids-neows"],           // 每日
  "0 */12 * * *":  ["donki", "eonet"],                    // 每 12 小时
  "0 0 * * 0":     ["epic", "mars-rover-photos", "earth"], // 每周
  "0 0 1 * *":     ["nasa-ivl", "exoplanet", "genelab", "techport", "techtransfer"] // 每月
};
```

**效果：**
- 月存储：~500MB
- 完全在免费额度内
- 保留核心数据

### 方案 C：当前方案（保持）

```javascript
const SCHEDULE_MAP = {
  daily:   ["apod", "asteroids-neows", "donki", "epic", "mars-rover-photos"],
  hourly:  ["eonet", "nasa-ivl"],
  weekly:  ["exoplanet", "genelab", "techport", "techtransfer", "earth"]
};
```

**效果：**
- 月存储：~2.1GB
- 年成本：$5.36
- 数据完整

## 📊 成本对比

| 方案 | 月存储 | 年成本 | 数据完整性 |
|------|--------|--------|-----------|
| **方案 A（推荐）** | 1.5GB | $2.70 | 95% |
| **方案 B（省钱）** | 500MB | $0 | 80% |
| **方案 C（当前）** | 2.1GB | $5.36 | 100% |

## 🎯 最终建议

### 推荐：方案 A（平衡方案）

**理由：**
1. ✅ 提高关键 API 实时性（DONKI, EPIC）
2. ✅ 降低低价值 API 频率（Exoplanet, TechPort）
3. ✅ 节省 30% 存储成本
4. ✅ 保持 95% 数据完整性

**调整内容：**
```javascript
// 增加频率
donki: 每日 → 每 6 小时
epic: 每日 → 每 6 小时

// 降低频率
nasa-ivl: 每小时 → 每 6 小时
mars-rover-photos: 每日 → 每周
exoplanet: 每周 → 每月
techport: 每周 → 每月
```

### 如果预算充足：保持方案 C

**理由：**
- 年成本仅 $5.36
- 数据最完整
- 无需调整

## 📝 实施步骤

1. 备份当前配置
2. 修改 `SCHEDULE_MAP` 和 `wrangler.toml`
3. 测试新调度
4. 监控 1 周
5. 根据实际情况微调

## 🔍 监控指标

- R2 存储增长速度
- API 调用成功率
- 数据重复率
- 用户访问模式

**建议：先运行 1 个月，收集数据后再优化** ✅
